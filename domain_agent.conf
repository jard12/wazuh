<agent_config os="windows">

  <!-- ===== Event Channels (kernlogs) ===== -->
  <localfile>
    <location>Security</location>
    <log_format>eventchannel</log_format>
  </localfile>
  <localfile>
    <location>System</location>
    <log_format>eventchannel</log_format>
  </localfile>
  <localfile>
    <location>Application</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- ===== Active Directory / Domain Service ===== -->
  <localfile>
    <location>Directory Service</location>
    <log_format>eventchannel</log_format>
  </localfile>
  <localfile>
    <location>Microsoft-Windows-ActiveDirectory_DomainService/Directory Service</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- ===== DNS Server (server & client side) ===== -->
  <!-- Client-side queries (DC zelf doet lookup) -->
  <localfile>
    <location>Microsoft-Windows-DNS-Client/Operational</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- Server-side DNS logbestand (queries van clients via DC) -->
  <localfile>
    <location>C:\Windows\System32\dns\log.txt</location>
    <log_format>syslog</log_format>
  </localfile>

  <!-- ===== DHCP Server (IP lease events) ===== -->
  <localfile>
    <location>Microsoft-Windows-DHCP-Server/Operational</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- ===== Netlogon & Group Policy (logons & GPO updates) ===== -->
  <localfile>
    <location>Microsoft-Windows-Netlogon/Operational</location>
    <log_format>eventchannel</log_format>
  </localfile>
  <localfile>
    <location>Microsoft-Windows-GroupPolicy/Operational</location>
    <log_format>eventchannel</log_format>
  </localfile>

  <!-- ===== PowerShell (script detectie) ===== -->
  <localfile>
    <location>Microsoft-Windows-PowerShell/Operational</location>
    <log_format>eventchannel</log_format>
  </localfile>

</agent_config>
